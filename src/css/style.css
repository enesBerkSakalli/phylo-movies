/* Material Design 3 - Light Theme System */
:root {
  /* MD3 Color Tokens - Light Theme */
  --md-sys-color-primary: rgb(65 95 145);
  --md-sys-color-primary-container: rgb(214 227 255);
  --md-sys-color-on-primary: rgb(255 255 255);
  --md-sys-color-on-primary-container: rgb(40 71 119);
  --md-sys-color-secondary: rgb(86 95 113);
  --md-sys-color-secondary-container: rgb(218 226 249);
  --md-sys-color-on-secondary: rgb(255 255 255);
  --md-sys-color-on-secondary-container: rgb(62 71 89);
  --md-sys-color-tertiary: rgb(112 85 117);
  --md-sys-color-tertiary-container: rgb(250 216 253);
  --md-sys-color-on-tertiary: rgb(255 255 255);
  --md-sys-color-on-tertiary-container: rgb(87 62 92);
  --md-sys-color-error: rgb(186 26 26);
  --md-sys-color-error-container: rgb(255 218 214);
  --md-sys-color-on-error: rgb(255 255 255);
  --md-sys-color-on-error-container: rgb(147 0 10);
  /* Data Visualization Colors - Prefixed to prevent UI leakage */
  --viz-chart-highlight: var(--md-sys-color-tertiary);
  --viz-timeline-full-tree: #FF6B35;
  --viz-timeline-full-tree-border: #FF4500;

  /* Primary visualization colors */
  --viz-primary: #6750a4; /* Current selection - same as primary */
  --viz-secondary: #4a7c7e; /* Teal for secondary data */
  --viz-neutral: #79747e; /* Gray for inactive/background data */
  --viz-accent: #b3261e; /* Red for alerts/errors */

  /* Chart/timeline specific colors */
  --chart-active: var(--viz-primary);
  --chart-inactive: var(--viz-neutral);
  --chart-comparison: var(--viz-secondary);
  --chart-background: rgba(121, 116, 126, 0.20); /* Fallback for browsers without color-mix */

/* Surface Colors - MD3 Light Theme */
  --md-sys-color-surface: rgb(249 249 255);
  --md-sys-color-surface-container: rgb(237 237 244);
  --md-sys-color-surface-container-low: rgb(243 243 250);
  --md-sys-color-surface-container-high: rgb(231 232 238);
  --md-sys-color-surface-container-highest: rgb(226 226 233);
  --md-sys-color-surface-container-lowest: rgb(255 255 255);
  --md-sys-color-surface-dim: rgb(217 217 224);
  --md-sys-color-surface-bright: rgb(249 249 255);
  --md-sys-color-surface-tint: rgb(65 95 145);

  /* Text Colors - Light Theme - WCAG AA Compliant */
  --md-sys-color-on-surface: rgb(25 28 32);
  --md-sys-color-on-surface-variant: rgb(68 71 78);
  --md-sys-color-on-surface-variant-strong: rgb(46 48 54); /* Darker variant for high emphasis text */

  /* Additional accessible text colors */
  --md-sys-color-on-surface-disabled: #7a7a7a; /* For disabled states */
  --md-sys-color-on-surface-subtle: #2d2d2d; /* Between primary and variant */

  /* Border/Outline - Light Theme */
  --md-sys-color-outline: rgb(116 119 127);
  --md-sys-color-outline-variant: rgb(196 198 208);

  /* Missing MD3 Tokens */
  --md-sys-color-surface-variant: rgb(224 226 236);

  /* Inverse Colors - Light Theme */
  --md-sys-color-inverse-surface: rgb(46 48 54);
  --md-sys-color-inverse-on-surface: rgb(240 240 247);
  --md-sys-color-inverse-primary: rgb(170 199 255);

  /* Scrim and Shadow */
  --md-sys-color-scrim: #000000;
  --md-sys-color-shadow: #000000;

  /* Spacing Scale (4dp grid - MD3 compliant) */
  --md-sys-spacing-0: 0px;
  --md-sys-spacing-1: 4px;
  --md-sys-spacing-2: 8px;
  --md-sys-spacing-3: 12px;
  --md-sys-spacing-4: 16px;
  --md-sys-spacing-5: 20px;
  --md-sys-spacing-6: 24px;
  --md-sys-spacing-7: 28px;
  --md-sys-spacing-8: 32px;
  --md-sys-spacing-9: 36px;
  --md-sys-spacing-10: 40px;
  --md-sys-spacing-11: 44px;
  --md-sys-spacing-12: 48px;
  --md-sys-spacing-13: 52px;
  --md-sys-spacing-14: 56px;
  --md-sys-spacing-15: 60px;
  --md-sys-spacing-16: 64px;

  /* Shape/Border Radius */
  --md-sys-shape-corner-extra-small: 4px;
  --md-sys-shape-corner-small: 6px;
  --md-sys-shape-corner-medium: 8px;
  --md-sys-shape-corner-large: 12px;
  --md-sys-shape-corner-full: 20px;

  /* Component Sizes */
  --md-sys-size-button-height: 36px;
  --md-sys-size-button-height-compact: 28px;

  /* Elevation - MD3 Tonal Elevation System with Shadows */
  --md-sys-elevation-level-0: var(--md-sys-color-surface);
  --md-sys-elevation-level-1: var(--md-sys-color-surface-container-low);
  --md-sys-elevation-level-2: var(--md-sys-color-surface-container);
  --md-sys-elevation-level-3: var(--md-sys-color-surface-container-high);
  --md-sys-elevation-level-4: var(--md-sys-color-surface-container-highest);
  --md-sys-elevation-level-5: var(--md-sys-color-surface-container-highest);

  /* Elevation Shadow System - MD3 Spec Compliant */
  --md-sys-elevation-shadow-level-0: none;
  --md-sys-elevation-shadow-level-1: none; /* MD3 Level 1 uses tonal overlay only */
  --md-sys-elevation-shadow-level-2: 0px 1px 2px 0px rgba(0, 0, 0, 0.3), 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
  --md-sys-elevation-shadow-level-3: 0px 1px 3px 0px rgba(0, 0, 0, 0.3), 0px 1px 2px 0px rgba(0, 0, 0, 0.15);
  --md-sys-elevation-shadow-level-4: 0px 2px 3px 0px rgba(0, 0, 0, 0.3), 0px 6px 10px 4px rgba(0, 0, 0, 0.15);
  --md-sys-elevation-shadow-level-5: 0px 4px 4px 0px rgba(0, 0, 0, 0.3), 0px 8px 12px 6px rgba(0, 0, 0, 0.15);

  /* Elevation Overlay Tints - MD3 Primary Overlays */
  --md-elev-overlay-1: rgba(103, 80, 164, 0.05); /* Fallback */
  --md-elev-overlay-2: rgba(103, 80, 164, 0.08);
  --md-elev-overlay-3: rgba(103, 80, 164, 0.11);
  --md-elev-overlay-4: rgba(103, 80, 164, 0.12);
  --md-elev-overlay-5: rgba(103, 80, 164, 0.24); /* MD3 spec: 24% overlay at level 5 */

  /* Navigation Layout - MD3 Spec */
  --nav-width-default: 280px; /* Reduced from 360px for better space utilization */
  --nav-width-medium: 260px;
  --nav-width-small: 240px;
  --md-sys-font-family-monospace: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
  --md-sys-font-family-sans: 'Heebo', sans-serif;

  /* Font Weight Tokens */
  --font-weight-regular: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;

  /* Additional Font Size Tokens */
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 16px;
  --font-size-lg: 18px;
  --font-size-xl: 20px;

  /* Missing Spacing Tokens */
  /* State Layer Opacity Tokens */
  --md-sys-state-hover: rgba(0, 0, 0, 0.08);
  --md-sys-state-focus: rgba(0, 0, 0, 0.12);
  --md-sys-state-pressed: rgba(0, 0, 0, 0.16);
  --md-sys-state-dragged: rgba(0, 0, 0, 0.16);

  /* MD3 Type Scale Tokens */
  --md-typescale-title-medium-size: 16px;
  --md-typescale-title-medium-lineheight: 24px;
  --md-typescale-title-small-size: 14px;
  --md-typescale-title-small-lineheight: 20px;
  --md-typescale-body-large-size: 16px;
  --md-typescale-body-large-lineheight: 24px;
  --md-typescale-body-medium-size: 14px;
  --md-typescale-body-medium-lineheight: 20px;
  --md-typescale-body-small-size: 12px;
  --md-typescale-body-small-lineheight: 16px;
  --md-typescale-label-large-size: 14px;
  --md-typescale-label-large-lineheight: 20px;
  --md-typescale-label-medium-size: 12px;
  --md-typescale-label-medium-lineheight: 16px;
  --md-typescale-label-small-size: 11px;
  --md-typescale-label-small-lineheight: 16px;
}

/* Modern browsers with color-mix support */
@supports (background: color-mix(in srgb, red 50%, blue)) {
  :root {
    --chart-background: color-mix(in srgb, var(--viz-neutral) 20%, transparent);

    /* Update elevation overlays with color-mix for dynamic primary color */
    --md-elev-overlay-1: color-mix(in srgb, var(--md-sys-color-primary) 5%, transparent);
    --md-elev-overlay-2: color-mix(in srgb, var(--md-sys-color-primary) 8%, transparent);
    --md-elev-overlay-3: color-mix(in srgb, var(--md-sys-color-primary) 11%, transparent);
    --md-elev-overlay-4: color-mix(in srgb, var(--md-sys-color-primary) 12%, transparent);
    --md-elev-overlay-5: color-mix(in srgb, var(--md-sys-color-primary) 24%, transparent); /* MD3 spec: 24% overlay at level 5 */
  }
}

/* Reset and Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  font-size: 16px; /* MD3 minimum base font size */
  height: 100%;
}

body {
  min-height: 100%;
  width: 100%;
  font-family: var(--font-family-sans-serif, 'Heebo', sans-serif);
  background: var(--md-sys-color-surface);
  color: var(--md-sys-color-on-surface);
  font-size: var(--md-typescale-body-medium-size);
  line-height: 1.6;
}

/* General Styles */
.container {
  display: flex;
  flex-direction: row;
  width: 100%;
  height: calc(100vh - var(--movie-bar-height, 100px)); /* Account for fixed movie player bar */
}

.full-size-container {
  flex: 1 1 0%;
  min-width: 0;
  min-height: 0;
  background: var(--md-sys-color-surface);
  display: flex;
  align-items: stretch;
  justify-content: stretch;
  overflow: hidden; /* Prevent double scrollbar */
  position: relative;
}

#application-container {
  width: 100%;
  height: 100%;
  align-self: stretch;
  display: block;
  /* Removed padding to give full space to visualization */
  box-sizing: border-box;
}

/* SVG container should fill available space */
#application-container svg {
  width: 100%;
  height: 100%;
}

/* WebGL container styling for consistent sizing */
#webgl-container {
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden;
}

#webgl-container canvas {
  display: block;
  width: 100% !important;
  height: 100% !important;
}

/* Utility class to hide elements */
.hidden {
  display: none !important;
}

.header {
  display: flex;
}

.logo {
  padding-top: 5px;
  padding-inline: 20px;
}

.fa-film {
  color: var(--md-sys-color-on-surface);
}

.row {
  display: flex;
  align-items: center;
  margin-block-end: var(--md-sys-spacing-2); /* 8px - MD3 compliant */
}

/* Text and Headers */
h1 {
  font-size: 1.5em; /* Typically 24px if base is 16px */
  margin-bottom: 16px; /* Added some default spacing */
  color: var(--md-sys-color-on-surface); /* Ensure h1 uses theme text color */
}


/* Tooltip Styles */
.tooltip {
  position: absolute;
  opacity: 0;
  background-color: var(--md-sys-color-inverse-surface);
  border-radius: var(--md-sys-shape-corner-small);
  padding: var(--md-sys-spacing-1) var(--md-sys-spacing-2);
  font-size: var(--md-typescale-body-small-size);
  line-height: var(--md-typescale-body-small-lineheight);
  font-weight: var(--font-weight-regular);
  font-family: var(--font-family-sans-serif, 'Heebo', sans-serif);
  color: var(--md-sys-color-inverse-on-surface);
  pointer-events: none;
  white-space: nowrap;
  z-index: 1000;
  transition: opacity 0.3s;
}

.winbox.modern.modal {
  border-radius: var(--md-sys-shape-corner-medium);
  background: var(--md-sys-elevation-level-2);
  border: 1px solid var(--md-sys-color-outline-variant);
}

.winbox.modern.modal .wb-body {
  background: var(--md-sys-elevation-level-2);
}

.winbox.modern.modal .wb-title {
  font-family: var(--font-family-sans-serif, 'Heebo', sans-serif);
  font-weight: var(--font-weight-medium, 500);
  font-size: var(--font-size-lg, 18px);
  color: var(--md-sys-color-on-surface);
}

/* ============================================================================
   MD3 ELEVATION HELPER CLASSES
   ============================================================================ */

/* Elevation Level 1 - Tonal overlay only */
.elev-1 {
  background: var(--md-sys-elevation-level-1);
  box-shadow: none;
  position: relative;
}

.elev-1::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--md-elev-overlay-1);
  border-radius: inherit;
  pointer-events: none;
}

/* Elevation Level 2 - Tonal overlay + subtle shadow */
.elev-2 {
  background: var(--md-sys-elevation-level-2);
  box-shadow: var(--md-sys-elevation-shadow-level-2);
  position: relative;
}

.elev-2::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--md-elev-overlay-2);
  border-radius: inherit;
  pointer-events: none;
}

/* Elevation Level 3 - Tonal overlay + medium shadow */
.elev-3 {
  background: var(--md-sys-elevation-level-3);
  box-shadow: var(--md-sys-elevation-shadow-level-3);
  position: relative;
}

.elev-3::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--md-elev-overlay-3);
  border-radius: inherit;
  pointer-events: none;
}

/* Elevation Level 4 - Tonal overlay + strong shadow */
.elev-4 {
  background: var(--md-sys-elevation-level-4);
  box-shadow: var(--md-sys-elevation-shadow-level-4);
  position: relative;
}

.elev-4::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--md-elev-overlay-4);
  border-radius: inherit;
  pointer-events: none;
}

/* Elevation Level 5 - Tonal overlay + strongest shadow */
.elev-5 {
  background: var(--md-sys-elevation-level-5);
  box-shadow: var(--md-sys-elevation-shadow-level-5);
  position: relative;
}

.elev-5::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--md-elev-overlay-5);
  border-radius: inherit;
  pointer-events: none;
}
