<!-- Movie Player Bar - Timeline and Transport Controls -->
<div class="movie-player-bar" role="region" aria-label="Movie Player Controls">

  <div class="movie-player-container">

    <!-- CONTROLS ROW - SPANS FULL WIDTH -->
    <div class="controls-row" role="group" aria-label="Transport controls and chart controls">
      <!-- LEFT SIDE: Transport and Speed Controls -->
      <div class="left-controls" role="group" aria-label="Transport controls and position">
        <!-- Navigation Toggle -->
        <md-icon-button id="nav-toggle-button" title="Toggle navigation panel" aria-label="Toggle navigation panel">
          <md-icon>menu</md-icon>
        </md-icon-button>
        <!-- Speed Control -->
        <div class="speed-control" role="group" aria-labelledby="speed-control-label">
          <md-icon>speed</md-icon>
          <md-slider id="animation-speed-range" min="0.1" max="5" value="1" step="0.1" labeled aria-label="Animation speed"></md-slider>
        </div>
        <!-- Transport Controls -->
        <md-icon-button class="transport-button" id="backwardStepButton" title="Go to previous tree" aria-label="Previous tree">
          <md-icon>first_page</md-icon>
        </md-icon-button>
        <md-icon-button class="transport-button" id="backward-button" title="Go to previous frame" aria-label="Previous frame">
          <md-icon>chevron_left</md-icon>
        </md-icon-button>
        <md-icon-button toggle class="transport-button" id="play-button" title="Play/Pause animation" aria-label="Play/Pause animation">
          <md-icon>play_arrow</md-icon>
          <md-icon slot="selected">pause</md-icon>
        </md-icon-button>
        <md-icon-button class="transport-button" id="forward-button" title="Go to next frame" aria-label="Next frame">
          <md-icon>chevron_right</md-icon>
        </md-icon-button>
        <md-icon-button class="transport-button" id="forwardStepButton" title="Go to next tree" aria-label="Next tree">
          <md-icon>last_page</md-icon>
        </md-icon-button>

        <div class="vertical-divider"></div>

        <md-icon-button id="start-record" class="record-button-danger" title="Start screen recording">
          <md-icon>fiber_manual_record</md-icon>
        </md-icon-button>
        <md-icon-button id="stop-record" title="Stop screen recording" disabled>
          <md-icon>stop_circle</md-icon>
        </md-icon-button>
      </div>

    </div>

    <!-- TIMELINE CONTAINER - SPANS FULL WIDTH -->
    <div class="timeline-container-full-width">
      <div class="interpolation-timeline-container">
        <div class="interpolation-timeline-header">
          <!-- Removed timeline title to save space -->
          <md-chip-set class="timeline-header-metrics">
            <!-- Primary Metrics -->
            <md-suggestion-chip elevated title="Total number of trees in the phylogenetic movie sequence">
              <md-icon slot="icon">account_tree</md-icon>
              <span id="movieTimelineCount">0 trees</span>
            </md-suggestion-chip>
            <md-suggestion-chip elevated title="Current position: Shows current tree index and nearest full tree position">
              <md-icon slot="icon">my_location</md-icon>
              <span id="currentPositionInfo"></span>
            </md-suggestion-chip>
            <!-- Status Metric - Visual Only -->
            <md-suggestion-chip elevated title="Playback status: Current animation state and tree type being displayed">
              <span id="interpolationStatus"></span>
            </md-suggestion-chip>
          </md-chip-set>
          <div class="timeline-header-right">
            <div class="timeline-zoom-controls">
              <md-icon-button id="zoomOutBtn" title="Zoom out timeline (Ctrl + -)">
                <md-icon>zoom_out</md-icon>
              </md-icon-button>
              <md-icon-button id="fitToWindowBtn" title="Fit entire timeline to window (Ctrl + 0)">
                <md-icon>fit_screen</md-icon>
              </md-icon-button>
              <md-icon-button id="zoomInBtn" title="Zoom in timeline (Ctrl + +)">
                <md-icon>zoom_in</md-icon>
              </md-icon-button>
            </div>
            <div class="timeline-scroll-controls">
              <md-icon-button id="scrollToStartBtn" title="Scroll to start (Home)">
                <md-icon>first_page</md-icon>
              </md-icon-button>
              <md-icon-button id="scrollToEndBtn" title="Scroll to end (End)">
                <md-icon>last_page</md-icon>
              </md-icon-button>
            </div>
          </div>
        </div>
        <!-- DOM-based timeline removed - using vis-timeline only -->
        <!-- vis-timeline container will be created dynamically by MovieTimelineManager -->
      </div> <!-- .interpolation-timeline-container CLOSES HERE -->
    </div> <!-- .timeline-container-full-width CLOSES HERE -->

    <!-- CHART CONTAINER - SPANS FULL WIDTH -->
    <div class="movie-chart-container-full-width" role="region" aria-label="Distance Chart">
      <div class="chart-row">
        <div
          id="lineChart"
          class="chart-canvas chart-inline"
          role="img"
          aria-label="Interactive distance chart"
          title="Interactive chart: Click points or drag indicator to navigate"
        ></div>
        <div class="chart-controls" role="group" aria-label="Chart controls">
          <md-outlined-select
            name="barPlotOption"
            id="barPlotOption"
            aria-describedby="chart-select-help"
            title="Choose data series to display"
            value="rfd"
          >
            <md-select-option value="rfd" selected>
              <div slot="headline">RFD</div>
            </md-select-option>
            <md-select-option value="w-rfd">
              <div slot="headline">W-RFD</div>
            </md-select-option>
            <md-select-option value="scale">
              <div slot="headline">Scale</div>
            </md-select-option>
            <md-select-option value="ignore-branch-lengths">
              <div slot="headline">Ignore Branch Lengths</div>
            </md-select-option>
          </md-outlined-select>
          <md-filled-tonal-button
            id="chart-modal"
            aria-label="Open full-size chart view"
            title="Open full-size interactive chart view"
          >
            <md-icon slot="icon">open_in_new</md-icon>
          </md-filled-tonal-button>
          <div id="chart-select-help" class="sr-only">Choose data series: RFD shows tree differences, W-RFD includes branch lengths, Scale shows tree size</div>
        </div>
      </div>
    </div>
  </div> <!-- .movie-player-container CLOSES HERE -->
</div> <!-- .movie-player-bar CLOSES HERE -->
