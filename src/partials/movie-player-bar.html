<!-- Movie Player Bar - Timeline and Transport Controls -->
<div class="movie-player-bar" role="region" aria-label="Movie Player Controls">

  <div class="movie-player-container">

    <!-- CONTROLS ROW - SPANS FULL WIDTH -->
    <div class="controls-row" role="group" aria-label="Transport controls and chart controls">
      <!-- LEFT SIDE: Transport and Speed Controls -->
      <div class="left-controls" role="group" aria-label="Transport controls and position">
        <!-- Navigation Toggle -->
        <md-icon-button id="nav-toggle-button" title="Toggle navigation panel" aria-label="Toggle navigation panel">
          <md-icon>menu</md-icon>
        </md-icon-button>

        <div class="vertical-divider"></div>

        <!-- Timeline Zoom Controls -->
        <div class="timeline-zoom-controls" role="group" aria-label="Timeline zoom controls">
          <md-icon-button id="zoomOutBtn" title="Zoom out timeline (Ctrl + -)">
            <md-icon>zoom_out</md-icon>
          </md-icon-button>
          <md-icon-button id="fitToWindowBtn" title="Fit entire timeline to window (Ctrl + 0)">
            <md-icon>fit_screen</md-icon>
          </md-icon-button>
          <md-icon-button id="zoomInBtn" title="Zoom in timeline (Ctrl + +)">
            <md-icon>zoom_in</md-icon>
          </md-icon-button>
        </div>

        <!-- Timeline Scroll Controls -->
        <div class="timeline-scroll-controls" role="group" aria-label="Timeline scroll controls">
          <md-icon-button id="scrollToStartBtn" title="Scroll to start (Home)">
            <md-icon>first_page</md-icon>
          </md-icon-button>
          <md-icon-button id="scrollToEndBtn" title="Scroll to end (End)">
            <md-icon>last_page</md-icon>
          </md-icon-button>
        </div>

        <div class="vertical-divider"></div>

        <!-- Speed Control -->
        <div class="speed-control" role="group" aria-labelledby="speed-control-label">
          <md-icon>speed</md-icon>
          <md-slider id="animation-speed-range" min="0.1" max="5" value="1" step="0.1" labeled aria-label="Animation speed"></md-slider>
        </div>
        <!-- Transport Controls -->
        <md-icon-button class="transport-button" id="backwardStepButton" title="Go to previous tree" aria-label="Previous tree">
          <md-icon>first_page</md-icon>
        </md-icon-button>
        <md-icon-button class="transport-button" id="backward-button" title="Go to previous frame" aria-label="Previous frame">
          <md-icon>chevron_left</md-icon>
        </md-icon-button>
        <md-icon-button toggle class="transport-button" id="play-button" title="Play/Pause animation" aria-label="Play/Pause animation">
          <md-icon>play_arrow</md-icon>
          <md-icon slot="selected">pause</md-icon>
        </md-icon-button>
        <md-icon-button class="transport-button" id="forward-button" title="Go to next frame" aria-label="Next frame">
          <md-icon>chevron_right</md-icon>
        </md-icon-button>
        <md-icon-button class="transport-button" id="forwardStepButton" title="Go to next tree" aria-label="Next tree">
          <md-icon>last_page</md-icon>
        </md-icon-button>

        <div class="vertical-divider"></div>

        <!-- Jump to Step Control -->
        <div class="jump-to-step-control" role="group" aria-labelledby="position-control-label">
          <input
            type="number"
            id="positionValue"
            name="pos"
            value="1"
            min="1"
            placeholder="Step"
            aria-label="Step number to jump to"
            title="Enter step number to navigate to"
            class="jump-to-step-field"
          />
          <button id="positionButton" title="Go to entered step" aria-label="Navigate to specified step" class="jump-button">
            Go
          </button>
        </div>

        <div class="vertical-divider"></div>

        <md-icon-button id="start-record" class="record-button-danger" title="Start screen recording">
          <md-icon>fiber_manual_record</md-icon>
        </md-icon-button>
        <md-icon-button id="stop-record" title="Stop screen recording" disabled>
          <md-icon>stop_circle</md-icon>
        </md-icon-button>
      </div>

    </div>

    <!-- TIMELINE CONTAINER - SPANS FULL WIDTH -->
    <div class="timeline-container-full-width">
      <div class="interpolation-timeline-container">
        <!-- Timeline container will be created dynamically by MovieTimelineManager -->
    </div> <!-- .interpolation-timeline-container CLOSES HERE -->
    </div> <!-- .timeline-container-full-width CLOSES HERE -->

    <!-- CHART CONTAINER - SPANS FULL WIDTH -->
    <div class="movie-chart-container-full-width" role="region" aria-label="Distance Chart">
      <div class="chart-row">
        <div
          id="lineChart"
          class="chart-canvas chart-inline"
          role="img"
          aria-label="Interactive distance chart"
          title="Interactive chart: Click points or drag indicator to navigate"
        ></div>
        <div class="chart-controls" role="group" aria-label="Chart controls">
          <select
            name="barPlotOption"
            id="barPlotOption"
            class="compact-select"
            aria-describedby="chart-select-help"
            title="Choose which tree distance metric to display in the chart"
          >
            <option value="rfd" selected title="Robinson-Foulds Distance: Measures topological differences between trees">RFD</option>
            <option value="w-rfd" title="Weighted Robinson-Foulds: Includes branch length differences">W‑RFD</option>
            <option value="scale" title="Tree scale: Shows relative size changes">Scale</option>
          </select>
          <button
            id="chart-modal"
            aria-label="Open full-size chart view"
            title="Open full-size interactive chart view"
            class="chart-modal-button"
          >
            Expand
          </button>
          <div id="chart-select-help" class="sr-only">Choose data series: RFD shows tree differences, W-RFD includes branch lengths, Scale shows tree size</div>
        </div>
      </div>
    </div>
  </div> <!-- .movie-player-container CLOSES HERE -->
</div> <!-- .movie-player-bar CLOSES HERE -->

<!-- FLOATING HUD SYSTEM - Always Visible -->
<div class="phylo-hud nav-visible" role="complementary" aria-label="Timeline Status Display">
  <div class="hud-metrics">
    <div class="hud-item">
      <md-icon>movie</md-icon>
      <span class="hud-label">Movie progress:</span>
      <span id="hudPositionInfo" aria-live="polite"></span>
    </div>
    
    <div class="hud-separator">•</div>
    
    <div class="hud-item">
      <md-icon>analytics</md-icon>
      <span class="hud-label">Interpolation:</span>
      <span id="hudSegmentInfo" aria-live="polite"></span>
    </div>
    
    <div class="hud-separator requires-msa" style="display: none;">•</div>
    
    <!-- MSA Window Item (hidden by default; shown only when data-has-msa="true") -->
    <div class="hud-item requires-msa" id="hud-msa-window-item" style="display: none;">
      <md-icon>view_column</md-icon>
      <span class="hud-label">MSA:</span>
      <span class="metrics-window">
        <span id="hudWindowStart" class="metrics-window-value">1</span>
        <span>-</span>
        <span id="hudWindowMid" class="metrics-window-value metrics-window-value--primary">50</span>
        <span>-</span>
        <span id="hudWindowEnd" class="metrics-window-value">100</span>
      </span>
    </div>
  </div>
</div>
