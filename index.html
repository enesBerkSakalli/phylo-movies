<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Phylo-Movies</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Preconnect to Google Fonts for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Material Symbols for Material Web Components -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap"
    >

    <!-- Google Fonts - Roboto -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
    >

    <!-- Material Web Components -->
    <script type="importmap">
      {
        "imports": {
          "@material/web/": "https://esm.run/@material/web/"
        }
      }
    </script>
    <script type="module">
      import '@material/web/button/filled-button.js';
      import '@material/web/button/outlined-button.js';
      import '@material/web/icon/icon.js';
      import '@material/web/switch/switch.js';
      import '@material/web/textfield/outlined-text-field.js';

      // Debug: Check if components are loaded
      window.addEventListener('load', () => {
        console.log('Material Web components loaded:', {
          'md-switch': customElements.get('md-switch') !== undefined,
          'md-filled-button': customElements.get('md-filled-button') !== undefined,
          'md-outlined-button': customElements.get('md-outlined-button') !== undefined,
          'md-icon': customElements.get('md-icon') !== undefined
        });
      });
    </script>

    <!-- Material Design CSS - Optimized Loading Order -->
    <link rel="stylesheet" type="text/css" href="/src/css/material-design.css">
    <link rel="stylesheet" type="text/css" href="/src/css/style.css">
  </head>

  <body>
    <!-- Top App Bar -->
    <header style="background: var(--md-sys-color-surface-container); border-bottom: 1px solid var(--md-sys-color-outline-variant); padding: 16px 24px;">
      <div style="max-width: 1200px; margin: 0 auto; display: flex; align-items: center; gap: 12px;">
        <md-icon style="color: var(--md-sys-color-primary); font-size: 24px;">biotech</md-icon>
        <h1 style="margin: 0; font-size: 22px; font-weight: 500; color: var(--md-sys-color-on-surface);">Phylo-Movies</h1>
      </div>
    </header>

    <!-- Main Content -->
    <main style="min-height: calc(100vh - 64px); background: var(--md-sys-color-surface);">
      <div style="max-width: 800px; margin: 0 auto; padding: 24px 16px;">

        <!-- Hero Section -->
        <section style="text-align: center; margin-bottom: 48px;">
          <div style="margin-bottom: 24px;">
            <md-icon style="color: var(--md-sys-color-primary); font-size: 48px;">account_tree</md-icon>
          </div>
          <h1 style="margin: 0 0 16px 0; font-size: 32px; font-weight: 500; color: var(--md-sys-color-on-surface);">Visualize Phylogenetic Evolution</h1>
          <p style="margin: 0 0 32px 0; font-size: 16px; color: var(--md-sys-color-on-surface-variant); max-width: 600px; margin-left: auto; margin-right: auto;">Transform your phylogenetic data into stunning interactive movies. Upload tree files and watch evolution unfold through advanced visualization and smooth interpolation.</p>
          <div style="display: flex; justify-content: center; gap: 32px; flex-wrap: wrap;">
            <div style="display: flex; align-items: center; gap: 8px; color: var(--md-sys-color-on-surface-variant);">
              <md-icon style="color: var(--md-sys-color-primary);">timeline</md-icon>
              <span>Interactive Timeline</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px; color: var(--md-sys-color-on-surface-variant);">
              <md-icon style="color: var(--md-sys-color-primary);">animation</md-icon>
              <span>Smooth Transitions</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px; color: var(--md-sys-color-on-surface-variant);">
              <md-icon style="color: var(--md-sys-color-primary);">palette</md-icon>
              <span>Rich Visualization</span>
            </div>
          </div>
        </section>

        <!-- Upload Form Card -->
        <section>
          <div style="background: var(--md-sys-color-surface-container-low); border-radius: 16px; padding: 24px; margin-bottom: 24px; border: 1px solid var(--md-sys-color-outline-variant);">
            <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
              <div style="flex: 1;">
                <h2 style="margin: 0; font-size: 24px; font-weight: 500; color: var(--md-sys-color-on-surface);">Upload & Configure</h2>
                <p style="margin: 4px 0 0 0; color: var(--md-sys-color-on-surface-variant);">Prepare your phylogenetic data for visualization</p>
              </div>
              <md-icon style="color: var(--md-sys-color-primary); font-size: 24px;">upload_file</md-icon>
            </div>

            <div id="form-alert" style="display: none; flex-direction: row; align-items: flex-start; gap: 12px; padding: 16px; border-radius: 12px; margin-bottom: 16px; background: var(--md-sys-color-error-container); color: var(--md-sys-color-on-error-container);" role="alert">
              <md-icon style="font-size: 20px; margin-top: 2px;">error</md-icon>
              <div style="flex: 1; display: flex; flex-direction: column; gap: 4px;">
                <span style="font-weight: 500; font-size: 16px;">Upload Error</span>
                <span style="font-size: 14px; opacity: 0.9;">Please check your files and try again.</span>
              </div>
            </div>

            <form id="phylo-form" enctype="multipart/form-data" style="display: flex; flex-direction: column; gap: 24px;">

              <!-- File Upload Grid -->
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 24px;">

                <!-- Required Files Section -->
                <div style="background: var(--md-sys-color-surface-container-lowest); padding: 24px; border-radius: 16px; border: 1px solid var(--md-sys-color-outline-variant); transition: all 0.2s ease;">
                  <h3 style="display: flex; align-items: center; gap: 8px; font-size: 18px; font-weight: 500; color: var(--md-sys-color-primary); margin: 0 0 16px 0; padding-bottom: 8px; border-bottom: 1px solid var(--md-sys-color-outline-variant);">
                    <md-icon style="font-size: 20px;">description</md-icon>
                    Required Files
                  </h3>

                  <!-- Tree File Input -->
                  <div style="display: flex; flex-direction: column; gap: 4px; width: 100%; margin-bottom: 16px;">
                    <label for="trees" style="font-size: 14px; font-weight: 500; color: var(--md-sys-color-on-surface); margin-bottom: 8px;">Tree File *</label>
                    <input
                      id="trees"
                      type="file"
                      required
                      accept=".tree,.nwk,.newick,.tre,.ph"
                      style="padding: 12px; border: 1px solid var(--md-sys-color-outline); border-radius: 8px; background: var(--md-sys-color-surface); color: var(--md-sys-color-on-surface); font-family: 'Roboto', sans-serif;"
                    >
                    <div style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: var(--md-sys-color-on-surface-variant); padding: 4px 12px; line-height: 1.4;">
                      <md-icon style="font-size: 16px; color: var(--md-sys-color-on-surface-variant);">cloud_upload</md-icon>
                      Newick format (.tree, .nwk, .newick)
                    </div>
                  </div>

                  <!-- Order File Input -->
                  <div style="display: flex; flex-direction: column; gap: 4px; width: 100%;">
                    <label for="order" style="font-size: 14px; font-weight: 500; color: var(--md-sys-color-on-surface); margin-bottom: 8px;">Order File</label>
                    <input
                      type="file"
                      id="order"
                      accept=".txt,.order"
                      style="padding: 12px; border: 1px solid var(--md-sys-color-outline); border-radius: 8px; background: var(--md-sys-color-surface); color: var(--md-sys-color-on-surface); font-family: 'Roboto', sans-serif;"
                    >
                    <div style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: var(--md-sys-color-on-surface-variant); padding: 4px 12px; line-height: 1.4;">
                      <md-icon style="font-size: 16px; color: var(--md-sys-color-on-surface-variant);">description</md-icon>
                      Optional: Tree ordering specification
                    </div>
                  </div>
                </div>

                <!-- Optional Files Section -->
                <div style="background: var(--md-sys-color-surface-container-lowest); padding: 24px; border-radius: 16px; border: 1px solid var(--md-sys-color-outline-variant); transition: all 0.2s ease;">
                  <h3 style="display: flex; align-items: center; gap: 8px; font-size: 18px; font-weight: 500; color: var(--md-sys-color-primary); margin: 0 0 16px 0; padding-bottom: 8px; border-bottom: 1px solid var(--md-sys-color-outline-variant);">
                    <md-icon style="font-size: 20px;">add_circle_outline</md-icon>
                    Optional Files
                  </h3>

                  <!-- MSA File Input -->
                  <div style="display: flex; flex-direction: column; gap: 4px; width: 100%;">
                    <label for="msa" style="font-size: 14px; font-weight: 500; color: var(--md-sys-color-on-surface); margin-bottom: 8px;">Multiple Sequence Alignment</label>
                    <input
                      type="file"
                      id="msa"
                      accept=".fas,.fasta,.aln,.clustal,.msa,.phylip,.phy"
                      style="padding: 12px; border: 1px solid var(--md-sys-color-outline); border-radius: 8px; background: var(--md-sys-color-surface); color: var(--md-sys-color-on-surface); font-family: 'Roboto', sans-serif;"
                    >
                    <div style="display: flex; align-items: center; gap: 4px; font-size: 12px; color: var(--md-sys-color-on-surface-variant); padding: 4px 12px; line-height: 1.4;">
                      <md-icon style="font-size: 16px; color: var(--md-sys-color-on-surface-variant);">biotech</md-icon>
                      FASTA, CLUSTAL, or PHYLIP format
                    </div>
                  </div>
                </div>

              </div>

              <!-- Parameters Section -->
              <div style="background: linear-gradient(135deg, var(--md-sys-color-surface-container-lowest) 0%, var(--md-sys-color-surface-container-low) 100%); padding: 24px; border-radius: 16px; border: 1px solid var(--md-sys-color-outline-variant);">
                <h3 style="display: flex; align-items: center; gap: 8px; font-size: 18px; font-weight: 500; color: var(--md-sys-color-primary); margin: 0 0 16px 0; padding-bottom: 8px; border-bottom: 1px solid var(--md-sys-color-outline-variant);">
                  <md-icon style="font-size: 20px;">tune</md-icon>
                  Visualization Parameters
                </h3>

                <!-- Parameters Grid -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; align-items: start;">

                  <!-- Number Inputs -->
                  <div style="display: flex; flex-direction: column; gap: 16px;">
                    <md-outlined-text-field
                      type="number"
                      id="windowSize"
                      name="windowSize"
                      label="Window Size"
                      value="1"
                      min="1"
                      required>
                    </md-outlined-text-field>

                    <md-outlined-text-field
                      type="number"
                      id="window-step-size"
                      name="windowStepSize"
                      label="Step Size"
                      value="1"
                      min="1"
                      required>
                    </md-outlined-text-field>
                  </div>

                  <!-- Options Section -->
                  <div style="background: var(--md-sys-color-surface-container); padding: 16px; border-radius: 12px; border: 1px solid var(--md-sys-color-outline-variant);">
                    <label style="display: flex; align-items: center; gap: 16px; cursor: pointer;">
                      <md-switch
                        id="midpointRooting"
                        name="midpointRooting"
                        value="on">
                      </md-switch>
                      <div style="flex: 1;">
                        <div style="font-weight: 500; color: var(--md-sys-color-on-surface);">Enable Midpoint Rooting</div>
                        <div style="font-size: 14px; color: var(--md-sys-color-on-surface-variant);">Automatically root trees at their midpoint</div>
                      </div>
                    </label>
                  </div>
                </div>
              </div>

              <!-- Action Buttons -->
              <div style="display: flex; gap: 12px; justify-content: flex-end; padding-top: 16px; margin-top: 16px; border-top: 1px solid var(--md-sys-color-outline-variant);">
                <md-outlined-button type="reset" has-icon>
                  <md-icon slot="icon">refresh</md-icon>
                  Reset
                </md-outlined-button>
                <md-filled-button type="submit" has-icon>
                  <md-icon slot="icon">play_arrow</md-icon>
                  Create Visualization
                </md-filled-button>
              </div>
            </form>
          </div>
        </section>
      </div>
    </main>
    <script type="module" src="/src/js/index.js"></script>

    <style>
      @media (max-width: 768px) {
        div[style*="grid-template-columns: 1fr 1fr"] {
          grid-template-columns: 1fr !important;
          gap: 16px !important;
        }
      }
    </style>
  </body>
</html>
